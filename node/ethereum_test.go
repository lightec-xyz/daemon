package node

import (
	"testing"

	"github.com/ethereum/go-ethereum/common/hexutil"
	"github.com/stretchr/testify/require"
)

func Test_decodeRedeemLog(t *testing.T) {
	// https://holesky.etherscan.io/tx/0x578b6beae157c2ebc22331f68314e68cb727f90eca0bdb1252bb083e4a1b1a83#eventlog
	dataStr := "0x000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000007d0200000001aaad0ef3f5142b7ccf8f1a1c1819f6a665a273ca946f4113a9868823e262e2c70100000000ffffffff026013000000000000160014ba6f4cae81f80ca51b18ecc598f3f744fe35a47f42d3000000000000220020efd9eeb78068445762a9e2e335d6ab826aaecff9cb7da24a39fc4686d468fb580000000000000000000000000000000000000000000000000000000000000000000000000000011f8f3b28cee761d632da471500b4f64608f875617933d7115518debbf9fb40f9"

	dataBytes, err := hexutil.Decode(dataStr)
	require.NoError(t, err)

	btcRawTx, sigHashs, err := decodeRedeemLog(dataBytes)
	require.NoError(t, err)

	t.Logf("btcRawTx: %v", hexutil.Encode(btcRawTx))
	t.Logf("sigHashs: %x", sigHashs)
}
